<!DOCTYPE html>
<html>

<head>

<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 14 (filtered)">
<link href="css/style.css" rel="stylesheet" type="text/css" media="screen">
<link href="css/style_print.css" rel="stylesheet" type="text/css" media="print">

<script type="text/javascript" src="js/jquery-2.1.0.js"></script> 

<script type="text/javascript" src="js/jspdf.source.js"></script>

<script type="text/javascript" src="js/handle-xls.js"></script>

<script type="text/javascript" src="js/makeCards.js"></script>

<script type="text/javascript" src="js/xls.js"></script>

<style>
#drop{
	border:2px dashed #bbb;
	-moz-border-radius:5px;
	-webkit-border-radius:5px;
	border-radius:5px;
	padding:25px;
	text-align:center;
	font:20pt bold,"Vollkorn";color:#bbb
}
#b64data{
	width:100%;
}

</style>

</head>
<body lang=EN-GB>
<script> 
$(document).ready(function() { 
		var fileInput = document.getElementById('fileInput');
		var fileDisplayArea = document.getElementById('fileDisplayArea');
		var allMembers = document.getElementById('allMembers');
		var noMembers = document.getElementById('noMembers');
		var data =0x0;
$('.preview-pane').attr('src','frame.html');
//$('.grid-pane').attr('src','grid.html');
 $("button[value='makeBlanks']").click(function() { 
  createCards("blanks"); 
 }); 
  $("button[value='printCards']").click(function() { 

  createCards("print"); 
 }); 
 
 var drop = document.getElementById('drop');
function handleDragover(e) {
	e.stopPropagation();
	e.preventDefault();
	e.dataTransfer.dropEffect = 'copy';
}

if(drop.addEventListener) {
	drop.addEventListener('dragenter', handleDragover, false);
	drop.addEventListener('dragover', handleDragover, false);
	drop.addEventListener('drop', handleDrop, false);
}
 


  fileInput.addEventListener('change', handleFileSelect, false);
  allMembers.addEventListener('change',handleallMembers,false);
  noMembers.addEventListener('change',handleallMembers,false);
  
 if(typeof(Storage)!=="undefined")
  {
  // Code for localStorage/sessionStorage.
 //	localStorage.removeItem("storedFY");
  if (localStorage.getItem("storedFY") ==null) {
   //document.getElementById("fyText").value='hhg';
   // set FY start by default to be this FY if before July
   var d = new Date();
  var y = d.getFullYear();
  var m=d.getMonth();
  if ( m <7 ) y = (parseInt(y)-1 ).toString();
   localStorage.storedFY = y;
  }
  document.getElementById("fyText").value=localStorage.getItem("storedFY");
 setFY(); }
else
  {
  // Sorry! No Web Storage support..
  alert("No local Storage available in This Browser");
  } 

 });
</script>
 <div id="navbox" style='padding:4.35pt 7.95pt 4.35pt 7.95pt;text-align:left;'>
<span id="navtext" ><p></p></span>
<br/>
<button type="button" value="printCards">Save Cards pdf</button>
<br> <br/>
<button type="button" value="makeBlanks">A Page of Blank Cards</button>

<br><br/>
<br> <br/>

<input type="radio" name="selection" id="allMembers" value="allMembers" checked>Show All <br>
<input type="radio" name="selection" id="noMembers" value="unused" >Only Unused Cards<br><br>
<input type="file" id="fileInput" name="fileInput" multiple />
<output id="list"></output>
<div id="drop">Drop an XLS file here to see sheet data.</div>
<br>
<form>
Financial Year Start (e.g.2013) : <input type="textbox" id="fyText" name="fyName" value=""><br>
</form>

<p>Change the start year for the Financial Year text.</p>

<p id="FY"><br></p>

<button id="fyClick" onclick="setFY()">Set FY text</button>
<!--
<textarea id="b64data">... or paste a base64-encoding here</textarea>
<input type="button" id="dotext" value="Click here to process the base64 text" onclick="b64it();"/>
-->

<br />
</div>
<div class="page-icon grid-pane" frameborder="0" >
<br>
<pre id="out"></pre>

</div>
<iframe class="page-icon preview-pane" frameborder="0" ></iframe>



</body></html>