function xlsworker(a,b){var c=new Worker("js/xlsworker.js");c.onmessage=function(a){switch(a.data.t){case"ready":break;case"e":console.error(a.data.d);case"xls":b(a.data.d)}},c.postMessage(a)}function get_radio_value(a){for(var b=document.getElementsByName(a),c=0;c<b.length;c++)if(b[c].checked)return b[c].value}function to_json(a){var b={};return a.SheetNames.forEach(function(c){var d=sheet_to_row_object_array_add_headings(a.Sheets[c],["c1","c2","c3","c4","c5","c6","c7","c8","c9","c10"]);d.length>0&&(b[c]=d)}),b}function to_csv(a){var b=[];return a.SheetNames.forEach(function(c){var d=XLS.utils.make_csv(a.Sheets[c]);d.length>0&&(b.push("SHEET: "+c),b.push(""),b.push(d))}),b.join("\n")}function to_formulae(a){var b=[];return a.SheetNames.forEach(function(c){var d=XLS.utils.get_formulae(a.Sheets[c]);d.length>0&&(b.push("SHEET: "+c),b.push(""),b.push(d.join("\n")))}),b.join("\n")}function b64it(){var a=XLS.CFB.read(tarea.value,{type:"base64"}),b=XLS.parse_xlscfb(a);process_wb(b)}function process_wb(a){var c,b="";c=to_json(a);var d;d=getLargestSheetFromObject(c);var f=rejigColumns(c[d]);sortOutput1(f),insertBlankMembers(f),padToFullPages(f,12),b=JSON.stringify(f,2,2),void 0===$(".grid-pane").text?out.textContent=b:$(".grid-pane").text(b),createCards("show",b)}function handleDrop(a){a.stopPropagation(),a.preventDefault();var c,d,b=a.dataTransfer.files;for(c=0,d=b[c];c!=b.length;++c){var e=new FileReader;d.name,e.onload=function(a){data=a.target.result,fileOnLoad(data)},e.readAsBinaryString(d)}}function fileOnLoad(a){if("undefined"!=typeof Worker)xlsworker(a,process_wb);else{var b=XLS.CFB.read(a,{type:"binary"}),c=XLS.parse_xlscfb(b);process_wb(c)}}function handleFileSelect(){var b=fileInput.files[0],d=new FileReader;d.onload=function(a){data=a.target.result,fileOnLoad(data)},d.readAsBinaryString(b)}function handleallMembers(){"undefined"!=typeof data&&(fileInput.files[0],fileOnLoad(data))}function setFY(){var a=document.getElementById("fyText").value;localStorage.storedFY=a;var b=parseInt(a)+1;document.getElementById("FY").innerHTML="(October "+a+"- September "+b+")"}function sheet_to_row_object_array_add_headings(a,b){var c,d,e,f,g,h,i=[];if(a["!ref"]){if(e=XLS.utils.decode_range(a["!ref"]),f={},"undefined"==b){for(h=e.s.c;h<=e.e.c;++h)if(c=a[encode_cell({c:h,r:e.s.r})])switch(c.t){case"s":case"str":f[h]=JSON.parse(c.v);break;case"n":f[h]=c.v}}else for(h=0;h<b.length;++h)f[h]=b[h];for(var j=e.s.r;j<e.e.r;++j){for(g=!0,d=Object.create({__rowNum__:j}),h=e.s.c;h<=e.e.c;++h){c=a[XLS.utils.encode_cell({c:h,r:j})];var k=(c||{}).v;if(void 0!==c)switch(c.t){case"s":case"str":void 0!==k&&(k=JSON.parse(k));case"b":case"n":void 0!==k&&(d[f[h]]=k,g=!1);break;case"e":break;default:throw"unrecognized type "+c.t}}g||i.push(d)}}return i}function getLargestSheetFromObject(a){var b=new Array,c=new Array,d=0,e=0,f=0;$.each(a,function(a,g){b[d]=a,c[d]=g,g.length>e&&(f=d,e=g.length),d++});var g=b[f];return g}function rejigColumns(a){for(var b=new Array,c={},d={},e=0;e<a.length;e++)if(rowContains(a[e],"edwards")&&rowContains(a[e],"allan")){c=a[e],$.each(c,function(a,b){switch(b){case 1:d.MembNum=a;break;case"Allan":d.FirstName=a;break;case"Edwards":d.SurName=a}});break}for(var e=0;e<a.length;e++)b[e]={},b[e].MembNum=a[e][d.MembNum],b[e].SurName=a[e][d.SurName],b[e].FirstName=a[e][d.FirstName];return b}function rowContains(a,b){new Array,new Array;var e=!1;return $.each(a,function(a,c){return"string"==typeof c&&c.toLowerCase()==b?(e=!0,!1):void 0}),e?!0:!1}function sortOutput1(a){for(var b=0;b<a.length;b++)void 0===a[b].MembNum&&(a.splice(b,1),b--);return a.sort(function(a,b){return a.MembNum>b.MembNum?1:a.MembNum<b.MembNum?-1:void 0}),a}function insertBlankMembers(a){for(var b=0,c=0,d=0;d<a.length;d++){if(c=a[d].MembNum-b,c>1)for(var e=0;c-1>e;e++)a.splice(d+e,0,{MembNum:b+1+e,FirstName:"",SurName:""});b=a[d].MembNum}return a}function padToFullPages(a,b){for(var c=a.length%b,d=b-c,e=a.length,f=0;d>f;f++)a.splice(f+e,0,{MembNum:"   ",FirstName:" ",SurName:" "});return a}function useOnlyUnused(a){for(var b=0;b<a.length;b++)a[b].SurName.length>0&&(a.splice(b,1),b--);return a}var tarea=document.getElementById("b64data"),drop=document.getElementById("drop");