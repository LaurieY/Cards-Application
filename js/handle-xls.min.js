function xlsworker(a,b){var c=new Worker("js/xlsworker.js");c.onmessage=function(a){switch(a.data.t){case "e":console.error(a.data.d);case "xls":b(a.data.d)}};c.postMessage(a)}function get_radio_value(a){a=document.getElementsByName(a);for(var b=0;b<a.length;b++)if(a[b].checked)return a[b].value}function to_json(a){var b={};a.SheetNames.forEach(function(c){var d=sheet_to_row_object_array_add_headings(a.Sheets[c],"c1 c2 c3 c4 c5 c6 c7 c8 c9 c10".split(" "));0<d.length&&(b[c]=d)});return b}
function to_csv(a){var b=[];a.SheetNames.forEach(function(c){var d=XLS.utils.make_csv(a.Sheets[c]);0<d.length&&(b.push("SHEET: "+c),b.push(""),b.push(d))});return b.join("\n")}function to_formulae(a){var b=[];a.SheetNames.forEach(function(c){var d=XLS.utils.get_formulae(a.Sheets[c]);0<d.length&&(b.push("SHEET: "+c),b.push(""),b.push(d.join("\n")))});return b.join("\n")}var tarea=document.getElementById("b64data");
function b64it(){var a=XLS.CFB.read(tarea.value,{type:"base64"}),a=XLS.parse_xlscfb(a);process_wb(a)}function process_wb(a){var b="";a=to_json(a);b=getLargestSheetFromObject(a);a=rejigColumns(a[b]);sortOutput1(a);insertBlankMembers(a);padToFullPages(a,12);b=JSON.stringify(a,2,2);void 0===$(".grid-pane").text?out.textContent=b:$(".grid-pane").text(b);createCards("show",b)}var drop=document.getElementById("drop");
function handleDrop(a){a.stopPropagation();a.preventDefault();a=a.dataTransfer.files;var b,c;b=0;for(c=a[b];b!=a.length;++b){var d=new FileReader;d.onload=function(a){a=a.target.result;"undefined"!==typeof Worker?xlsworker(a,process_wb):(a=XLS.CFB.read(a,{type:"binary"}),a=XLS.parse_xlscfb(a),process_wb(a))};d.readAsBinaryString(c)}}
function sheet_to_row_object_array_add_headings(a,b){var c,d,e,h,g,f,m=[];if(a["!ref"]){e=XLS.utils.decode_range(a["!ref"]);h={};if("undefined"==b)for(f=e.s.c;f<=e.e.c;++f){if(c=a[encode_cell({c:f,r:e.s.r})])switch(c.t){case "s":case "str":h[f]=JSON.parse(c.v);break;case "n":h[f]=c.v}}else for(f=0;f<b.length;++f)h[f]=b[f];for(var l=e.s.r;l<e.e.r;++l){g=!0;d=Object.create({__rowNum__:l});for(f=e.s.c;f<=e.e.c;++f){c=a[XLS.utils.encode_cell({c:f,r:l})];var k=(c||{}).v;if(void 0!==c)switch(c.t){case "s":case "str":void 0!==
k&&(k=JSON.parse(k));case "b":case "n":void 0!==k&&(d[h[f]]=k,g=!1);break;case "e":break;default:throw"unrecognized type "+c.t;}}g||m.push(d)}}return m}function getLargestSheetFromObject(a){var b=[],c=0,d=0,e=0;$.each(a,function(a,g){b[c]=a;g.length>d&&(e=c,d=g.length);c++});return b[e]}
function rejigColumns(a){for(var b=[],c={},d={},c=0;c<a.length;c++)if(rowContains(a[c],"edwards")&&rowContains(a[c],"allan")){c=a[c];$.each(c,function(a,b){switch(b){case 1:d.MembNum=a;break;case "Allan":d.FirstName=a;break;case "Edwards":d.SurName=a}});break}for(c=0;c<a.length;c++)b[c]={},b[c].MembNum=a[c][d.MembNum],b[c].SurName=a[c][d.SurName],b[c].FirstName=a[c][d.FirstName];return b}
function rowContains(a,b){var c=!1;$.each(a,function(a,e){if("string"===typeof e&&e.toLowerCase()==b)return c=!0,!1});return c?!0:!1}function sortOutput1(a){for(var b=0;b<a.length;b++)void 0===a[b].MembNum&&(a.splice(b,1),b--);a.sort(function(a,b){if(a.MembNum>b.MembNum)return 1;if(a.MembNum<b.MembNum)return-1});return a}
function insertBlankMembers(a){for(var b=0,c=0,d=0;d<a.length;d++){c=a[d].MembNum-b;if(1<c)for(var e=0;e<c-1;e++)a.splice(d+e,0,{MembNum:b+1+e,FirstName:"",SurName:""});b=a[d].MembNum}return a}function padToFullPages(a,b){for(var c=b-a.length%b,d=a.length,e=0;e<c;e++)a.splice(e+d,0,{MembNum:"   ",FirstName:" ",SurName:" "});return a}function useOnlyUnused(a){for(var b=0;b<a.length;b++)0<a[b].SurName.length&&(a.splice(b,1),b--);return a};