
/********************************createCards  *****/

function createCards(option,theList) {

var memberList;/*=[{SurName:"Benavides Pascual",FirstName:"Maria Teresa",MembNum:564,printed:''},
{SurName:"Edwards",FirstName:"Allan",MembNum:1},
{SurName:"Thomas",FirstName:"Brian",MembNum:2},
{SurName:"",FirstName:"",MembNum:3},
{SurName:"Rowat",FirstName:"Margaret",MembNum:4},
{SurName:"Kohler",FirstName:"Ingeborg",MembNum:5},
{SurName:"Lawlor",FirstName:"Mauna",MembNum:6},
{SurName:"Thomas",FirstName:"Carol",MembNum:7},
{SurName:"Watson",FirstName:"Brian",MembNum:8},
{SurName:"Gilhead",FirstName:"Jean ",MembNum:9},
{SurName:"Howard",FirstName:"Paul",MembNum:10},
{SurName:"Abbott",FirstName:"Harry",MembNum:11},
{SurName:"Joss",FirstName:"Jean",MembNum:12},
{SurName:"Siebrecht",FirstName:"Irmela",MembNum:13},
{SurName:"Heinen",FirstName:"Lola",MembNum:14},
{SurName:"Bayer",FirstName:"Jutta",MembNum:15},
{SurName:"Houben",FirstName:"Valerie",MembNum:16},
{SurName:"Woodhead",FirstName:"Jane",MembNum:17},
{SurName:"Van Tuijl",FirstName:"Pieter",MembNum:18},
{SurName:"Van Tuijl",FirstName:"Jo-Anne",MembNum:19},
{SurName:"Ellis",FirstName:"Jenny",MembNum:20},
{SurName:"Ellis",FirstName:"Rod",MembNum:21},
{SurName:"Huggett",FirstName:"Joan",MembNum:22},
{SurName:"Hambleton",FirstName:"Roger",MembNum:23},
{SurName:"Hambleton",FirstName:"Barbara",MembNum:24},
{SurName:"Beckett",FirstName:"Chris",MembNum:25},
{SurName:"Beckett",FirstName:"Dee",MembNum:26},
{SurName:"Hagley",FirstName:"Catharina",MembNum:27},
{SurName:"Mudie",FirstName:"Corrine",MembNum:28},
{SurName:"Finerty",FirstName:"John",MembNum:29},
{SurName:"Knott",FirstName:"Cara",MembNum:30},
{SurName:"Knott",FirstName:"Clement",MembNum:31},
{SurName:"McNamara",FirstName:"Eileen",MembNum:32},
{SurName:"Sanchez",FirstName:"Elena",MembNum:33},
{SurName:"Gross",FirstName:"Elizabeth",MembNum:34},
{SurName:"Gross",FirstName:"Jurgen",MembNum:35},
{SurName:"Gearon",FirstName:"Colin",MembNum:36},
{SurName:"Cavanagh",FirstName:"Shirley",MembNum:37},
{SurName:"Ableson",FirstName:"Jane",MembNum:38},
{SurName:"Houlihan",FirstName:"Marilyn",MembNum:39},
{SurName:"Sjokvist",FirstName:"Yvonne",MembNum:40},
{SurName:"Lacey",FirstName:"Lynn",MembNum:41},
{SurName:"Gearon",FirstName:"Susan",MembNum:42},
{SurName:"Coombes",FirstName:"Maureen",MembNum:43},
{SurName:"Whatmore",FirstName:"Carmel",MembNum:44},
{SurName:"Purcell",FirstName:"Vincent",MembNum:45},
{SurName:"Taylor",FirstName:"Laurie",MembNum:46},
{SurName:"Taylor",FirstName:"Josephine",MembNum:47},
{SurName:"Eklund",FirstName:"Anette",MembNum:48},
{SurName:"Graty",FirstName:"Tom",MembNum:49},
{SurName:"Da Costa",FirstName:"Michael",MembNum:50},
{SurName:"Scott",FirstName:"Bill",MembNum:51},
{SurName:"Scott",FirstName:"Anne",MembNum:52},
{SurName:"Moeller",FirstName:"Angret",MembNum:53},
{SurName:"O'Farrell",FirstName:"Betty",MembNum:54},
{SurName:"O'Farrell",FirstName:"Brian",MembNum:55},
{SurName:"Aston",FirstName:"Ginny",MembNum:56},
{SurName:"Kelly",FirstName:"James",MembNum:57},
{SurName:"Walters",FirstName:"Meta",MembNum:58},
{SurName:"Torres",FirstName:"Carmen",MembNum:59},
{SurName:"Cardenal",FirstName:"Julio",MembNum:60}]; */
//alert(memberList[0].SurName);

var FY="(October 2013 - September 2014)";
var MEMB = "MEMBERSHIP CARD";
/***************    Produce a page of blank cards as option ***/
if (option==="blanks") {   
blankMember={SurName:"",FirstName:"",MembNum:"   "}; // enough spaces in number to lose the leading '00'
  theList = [];
  for (var i = 0; i < 12; i++) {
    theList.push(blankMember);
  };
memberList = theList;
//out.innerText = JSON.stringify(theList, 2, 2);
var tempList = JSON.stringify(theList, 2, 2);
$(".grid-pane").html(tempList);
}
//else {memberList = JSON.parse($(".grid-pane").text());
else {
	switch(get_radio_value("selection")) {
		case "allMembers":
		memberList = JSON.parse($(".grid-pane").text());
		break; 
		case "unused":
		memberList = JSON.parse($(".grid-pane").text());
		useOnlyUnused(memberList);
		break;}

}


var doc = new jsPDF("portrait", "mm","a4",false);
var cardPage=0, carddNum=0,txtLen=0;
// We'll make our own renderer to skip this editor
/*var specialElementHandlers = {
        '#editor': function(element, renderer){
                return true;
        }
};*/
var fontlist = doc.getFontList();


//var imgData = 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wAARCAAlAD4DASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD1XU9Yh00orozswLHDBQo6ZJNUV8VQuGKW+4KMtiZDge/NQ+JADd4IBH2ZuD9a43wCq/2HJ8o5uGzx7LXlYrFVaUas429xxW2/Mr9zenCMpQi/tX/A7G88c6dp9i93cwy7AdqeUVfe393g8HvzWSnxY0uQEppeoPjrtVTj9a5vxUqr4StgqhR9oHAGP71Y2hXxkl0+0aWCBba4Mi4BEkpP8OenPTkivUwc3UwbryjdptdtF9/9anDXk4V1TTtdL8T0Gz+Kui3V1HA9reQiQ7Q7KpAPboc1uN4jCgsbGRVAyS0ijA9+a8c1HzD4tLS2htGa4Q+UcccjnjjnrxXe68ss+nS2VuwWa5VlBPoBk/4fjXJmWIlRlQVKyU1d31tt1XY2widSNTn15Xp0udMPEgIDfYZCpGcq6nI9ua2IZUnhSaM5SRQyn2Neb+EdQ+3aBErHMlt+6b8On6Y/KvQdL/5BNp/1wT/0EVnha1eVerRrWvB20+ZvOMPZwnD7SMzXraaS7ilWCSWMxFG2KWIOe4FctpGhajokU1tbRPJA8hdDJbuGTIxg4GD09q7u9jv32mxuIoiAciVNwJ7dPxqCWHWm8sRXVquFActGTk9yK1qYGFVybk7StdaW026EKq42str2+e/U4bxH4f1O/wDD6WtjYzyvburtuTaWHIOM9TznFYKaJrLRaes3hm8U2JzmGIAzc5G49R0969TaDX8ki9s+v3fKOP5/WpWg1cQEJeQGUkYLRcAc56de3612YelChSVJa2bd7u93o9rdzmqp1J8+2iX3HlMugeKdc8RRXc+izQfOv3htVFU56muubTrqa/M1xZPJEE2ojWzErzkn054/Kuomg1fcvkXlvtwu4PF19cYPGfxps8GtGRvs97bLGWJUPCSQOw61jisLSxChH4VFWVu2ndPsaUZSpOT3bd3c4rSfDt/pWpXVxHHI0N0cmBbZxtOcjBP1NegWETwafbwyDDxxKrDPcCqcsWuFEEN1aBguHLRk5bJ5+mMflWlGHEaCQguFG4joT3ohQUJuo5XbsunTRbJFKV0opWS/X5jqKKK1AKKKKACiiigAooooA//Z'
var imgData = "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4RDgRXhpZgAATU0AKgAAAAgABAE7AAIAAAAHAAAISodpAAQAAAABAAAIUpydAAEAAAAOAAAQyuocAAcAAAgMAAAAPgAAAAAc6gAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGx5YXRlcwAAAAWQAwACAAAAFAAAEKCQBAACAAAAFAAAELSSkQACAAAAAzkyAACSkgACAAAAAzkyAADqHAAHAAAIDAAACJQAAAAAHOoAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAyMDE0OjAyOjAyIDE0OjA0OjQ3ADIwMTQ6MDI6MDIgMTQ6MDQ6NDcAAABsAHkAYQB0AGUAcwAAAP/hCxlodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvADw/eHBhY2tldCBiZWdpbj0n77u/JyBpZD0nVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkJz8+DQo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIj48cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPjxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSJ1dWlkOmZhZjViZGQ1LWJhM2QtMTFkYS1hZDMxLWQzM2Q3NTE4MmYxYiIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIi8+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iPjx4bXA6Q3JlYXRlRGF0ZT4yMDE0LTAyLTAyVDE0OjA0OjQ3LjkyNDwveG1wOkNyZWF0ZURhdGU+PC9yZGY6RGVzY3JpcHRpb24+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iPjxkYzpjcmVhdG9yPjxyZGY6U2VxIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpsaT5seWF0ZXM8L3JkZjpsaT48L3JkZjpTZXE+DQoJCQk8L2RjOmNyZWF0b3I+PC9yZGY6RGVzY3JpcHRpb24+PC9yZGY6UkRGPjwveDp4bXBtZXRhPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8P3hwYWNrZXQgZW5kPSd3Jz8+/9sAQwAGBAUGBQQGBgUG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";
doc.addImage(imgData, 'JPEG', -10,-10, 16, 10,'u3aLogo');

// All units are in the set measurement for the document
// This can be changed to "pt" (points), "mm" (Default), "cm", "in"
/*var stringSize=0;
doc.setFontSize(10);
doc.cellInitialize();
doc.cell(10,10, 60, 10, ["MEMBERSHIP CARD"], 1, 'right');   */


var cardSize = {wd:79,ht:41};
var firstCard = {x:24,y:15};
var cardGaps = {x:4,y:4}; 
var horizonMove=cardSize.wd+cardGaps.x,vertMove= cardSize.ht+cardGaps.y;//

var nextCard=new Object();
//doc.addImage(imgData, 'JPEG', nextCard.x+(cardSize.wd/2)-8, nextCard.y+0.5, 16, 10);
for (cardPage=1;cardPage<=(memberList.length/12);cardPage++) {

nextCard.x=firstCard.x,nextCard.y =firstCard.y-vertMove;
makeLines(doc,cardSize,firstCard,cardGaps);
//doc.rect(nextCard.x,nextCard.y,cardSize.ht,cardSize.wd);
if (cardPage!=1) doc.addPage();
for (cardNum=0;cardNum<12;cardNum++) {
if (cardNum%2 !=1)
{// left side so move down
nextCard.x = firstCard.x;
nextCard.y += vertMove;
}
else
{// right side so move across
nextCard.x += horizonMove;
}
doc.setLineWidth(0.5);
myRect(doc,nextCard.x,nextCard.y,cardSize.wd,cardSize.ht);doc.rect(nextCard.x,nextCard.y,cardSize.wd,cardSize.ht);


//doc.addImage(imgData, 'JPEG', nextCard.x+(cardSize.wd/2)-8, nextCard.y+0.5, 16, 10);
//doc.addImage('u3aLogo', 'JPEG', nextCard.x+(cardSize.wd/2)-25, nextCard.y+0.5,50, 23);
doc.addImage('u3aLogo', 'JPEG', nextCard.x+(cardSize.wd/2)-25, nextCard.y+0.5,50,20); //positioned at mid pt less half the width of the image

doc.setTextColor(0,0,0);

//centreText(doc, MEMB, nextCard.x,cardSize.wd,(nextCard.y)+23, 'times', 8,'bold') ;
//txtLen=calcCentreText(doc, MEMB, cardSize.wd, 'times', 8,'bold');
//doc.text(MEMB,(nextCard.x+0.5+(cardSize.wd/2)-(txtLen/2)),(nextCard.y)+23) ;
centreText(doc,MEMB,nextCard,cardSize,23,'times', 8,'bold') ;

//txtLen=calcCentreText(doc, FY, cardSize.wd, 'times', 8,'normal');
//centreText(doc, FY, nextCard.x,cardSize.wd,(nextCard.y)+28, 'times', 8,'normal') ;
//doc.text(FY,(nextCard.x+0.5+(cardSize.wd/2)-(txtLen/2)),(nextCard.y)+28) ;	
centreText(doc,FY,nextCard,cardSize,28,'times', 8,'normal') ;


var memInd=((cardPage-1)*12)+cardNum;
membName= memberList[memInd].FirstName+" "+memberList[memInd].SurName;
var membFontSize=[13,12,11,10];
var z=0;
for (;membFontSize[z];z++)
{txtLen=calcCentreText(doc, membName, cardSize.wd, 'times', membFontSize[z],'bold');
if(txtLen < cardSize.wd*0.65) { // its a long name if the mid point of the card +1/2 the txtLen is > 60% of the card, it'll run into the NUMBER so reduce font size until it fits
	doc.setFontSize(membFontSize[z]);
doc.setFont('times','bold');
doc.text(membName,(nextCard.x+-0.5+(cardSize.wd*0.5)-(txtLen*0.5)),(nextCard.y)+36) ;		
break;}  //jumps out when the font is small enough
}




doc.setTextColor(153, 51, 102);
doc.setFontSize(13);
doc.setFont("times","bold");

var memberNum=memberList[memInd].MembNum;
doc.text(("00"+memberNum.toString()).substr(-3,3),nextCard.x+(cardSize.wd*0.87),(nextCard.y)+36);
}


}

if ((option==="show")||(option==="blanks")) {
var string = doc.output('datauristring');
//doc.output('datauri');
$('.preview-pane').attr('src', string); }
else
{

doc.save('Test.pdf');}
}
/******************************  makeLines *********/
function makeLines(doc,cardsize,firstcard,cardgaps) {
doc.setLineWidth(0.1)
doc.setDrawColor(0);
var leftLine = [5, firstcard.y-(cardgaps.y/2),20, firstcard.y-(cardgaps.y/2)];
var rightLine =[205, firstcard.y-(cardgaps.y/2),190, firstcard.y-(cardgaps.y/2)];

var topLine =[ firstcard.x-(cardgaps.x/2) ,5  , firstcard.x-(cardgaps.x/2) ,15 ];
var bottomLine =[ firstcard.x-(cardgaps.x/2) ,292  , firstcard.x-(cardgaps.x/2) ,280 ];
	for (card=1;card<4;card++)  {
		doc.line(topLine[0],topLine[1],topLine[2],topLine[3]);
		doc.line(bottomLine[0],bottomLine[1],bottomLine[2],bottomLine[3]);
		topLine[0]+= cardsize.wd+cardgaps.x;
		topLine[2] = topLine[0];
		bottomLine[0] =topLine[0];
		bottomLine[2] =topLine[0];
		}
	for (card=1;card<8;card++)  {
//doc.lines([[-8,0],[15,0]], 10,19.7, [1,1]); 
		doc.line(leftLine[0],leftLine[1],leftLine[2],leftLine[3]);
		doc.line(rightLine[0],rightLine[1],rightLine[2],rightLine[3]);
		leftLine[1] += cardsize.ht+cardgaps.y;
		leftLine[3] =leftLine[1];
		rightLine[1]  =leftLine[1];
		rightLine[3] =leftLine[1];
/*doc.lines([[4,0],[-15,0]], 205,19.7, [1,1]); 
doc.lines([[0,-8],[0,15]], 23.7,10, [1,1]); 
doc.lines([[0,-8],[0,15]], 104.55,10, [1,1]);  
doc.lines([[0,-8],[0,15]], 185.5,10, [1,1]); */
}
}

/*************** centreText **********/
/***** puts the text  onto the page, params the doc, the text, the LHS location x,the  card width, location y  , font, fontSize, fontStyle  ****   */
//centreText(doc, FY, nextCard.x,cardSize.wd,(nextCard.y)+28, 'times', 8,'normal') ;
function centreText(doc,txt,card,cardSize,yDispl,font,fontSize,fontStyle) {
var txtLen = calcCentreText(doc, txt,  card.wd,font, fontSize,fontStyle);
doc.setFontSize(fontSize);
doc.setFont(font,fontStyle);
doc.text(txt,(card.x+(cardSize.wd*0.5)-(txtLen*0.5)),(card.y+yDispl)) ;

}
/*************** calcCentreText **********/
/********* calculates the length of the string ***/

function calcCentreText(doc, txt,  wd,font, fontSize,fontStyle) {
doc.setFontSize(fontSize);
doc.setFont(font,fontStyle);
var txtLen;
//doc.setFontStyle('italic');
//var txtLen=doc.getTextDimensions(txt);  // in pts  **** Does NOT work in FF, <font> not supported in HTML5 anyway

   /*    var canvas = document.createElement('canvas');
		canvas.width = 	wd;
	    canvas.height = 100;
		var ctx = canvas.getContext('2d');
		ctx.font=fontSize+"pt "+font	; */

//txtLen= ctx.measureText(txt).width; /*  */ // in Pixels
//doc.text(txt, xLeft+0.5+(wd/2)-(txtLen*25.4/144) ,y);
//1 pixel = 0.264583 mm and 1 mm = 72/25.4 point
//var px2pt = 0.264583 * 72 / 25.4

txtLen = Math.ceil((doc.getStringUnitWidth(txt)*doc.internal.getFontSize())/(72/25.6));
//return (txtLen*0.264583333);  // length in mm
return (txtLen);  // length in mm
}

/****   myRect, allows for thicker lines, uses currently set line width */
function myRect(dc,x1,y1,wd,ht) {
dc.lines([[wd,0 ],[0,ht ], [-wd,0 ], [0,-ht]],x1,y1,  [1,1]);

}
